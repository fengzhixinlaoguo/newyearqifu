# 祈福灵签 - 快速启动指南

## ✅ 迁移完成清单

已成功迁移以下文件到 `/Users/guozengguang/ai/develop/project/newyearqifu`：

- ✅ package.json - 项目配置
- ✅ server.js - 后端服务器
- ✅ index.html - 前端页面
- ✅ ai-api.js - API调用模块
- ✅ render.html - 图片渲染模板
- ✅ .env - 环境变量配置（已复制原API Key）
- ✅ .gitignore - Git忽略规则
- ✅ start.sh - 快速启动脚本
- ✅ README.md - 项目说明
- ✅ node_modules/ - 依赖包（326个包已安装）

## 🚀 快速启动步骤

### 1. 进入项目目录

```bash
cd /Users/guozengguang/ai/develop/project/newyearqifu
```

### 2. 启动服务器

有三种启动方式：

**方式一：使用启动脚本（推荐）**
```bash
./start.sh
```

**方式二：使用 npm 命令**
```bash
npm start
```

**方式三：开发模式（自动重启）**
```bash
npm run dev
```

### 3. 访问应用

打开浏览器访问：
- **祈福灵签**: http://localhost:3000
- **健康检查**: http://localhost:3000/api/health

## 📝 当前 API 配置

默认使用阿里云通义千问 API：
- 端点: `https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions`
- 模型: `qwen-max`
- API Key: 已从原项目迁移

如需修改，请编辑 `server.js` 第 25-27 行。

## 🔧 故障排查

### API Key 未配置
如果看到警告：
```
⚠️  错误: API Key 未配置！
```

解决方法：
1. 编辑 `.env` 文件
2. 或者直接修改 `server.js` 第 25 行的 API Key

### 端口被占用
修改 `.env` 中的 `PORT` 值：
```env
PORT=3001
```

### 依赖问题
重新安装依赖：
```bash
rm -rf node_modules package-lock.json
npm install
```

## 📂 项目结构

```
newyearqifu/
├── server.js          # 后端服务（处理 AI API 调用）
├── index.html         # 前端页面（祈福界面）
├── ai-api.js          # 前端 API 模块（流式响应）
├── render.html        # 图片渲染模板（Puppeteer）
├── package.json       # 项目配置
├── .env              # 环境变量（包含 API Key）
├── .gitignore        # Git 忽略规则
├── start.sh          # 启动脚本
├── README.md         # 详细文档
└── node_modules/     # 依赖包（326个）
```

## 🎯 功能特性

- ✅ 抽签祈福 - 支持上上签、上吉签、中吉签
- ✅ AI 智能解签 - 流式输出，实时显示
- ✅ 生成分享图片 - Puppeteer 截图，高清分享
- ✅ 手机端优化 - 响应式设计
- ✅ API Key 完全隐藏 - 后端代理，安全可靠

## 🔐 安全提醒

⚠️ **重要**：
- `.env` 文件包含 API Key，已自动加入 `.gitignore`
- 绝对不要将 `.env` 提交到 Git
- 所有 API 调用都通过后端代理，前端无法看到 Key

## 📦 依赖说明

已安装的主要依赖：
- express - Web 服务器框架
- cors - 跨域支持
- dotenv - 环境变量管理
- puppeteer - 无头浏览器（生成图片）
- fluent-ffmpeg - 视频处理
- sqlite3 - 数据库支持
- nodemon - 开发模式自动重启

## 🧪 测试运行

快速测试项目是否正常：

```bash
# 启动服务
npm start

# 在浏览器访问
open http://localhost:3000

# 测试健康检查
curl http://localhost:3000/api/health
```

## 下一步

现在你可以：
1. 运行 `./start.sh` 启动服务
2. 访问 http://localhost:3000 开始使用
3. 如需修改端口，编辑 `.env` 文件

祝你好运！🎋
